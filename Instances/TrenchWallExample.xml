<?xml version="1.0" encoding="utf-8"?>
<Diggs xmlns="http://diggsml.org/schemas/3" xmlns:diggs="http://diggsml.org/schemas/3"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xlink="http://www.w3.org/1999/xlink"
  xmlns:gml="http://www.opengis.net/gml/3.2" xmlns:glr="http://www.opengis.net/gml/3.3/lr"
  xsi:schemaLocation="http://diggsml.org/schemas/3 https://diggsml.org/schemas/3.0.0/Diggs.xsd"
  gml:id="TrenchwallExample">
  <documentInformation>
    <DocumentInformation gml:id="d1">
      <creationDate>2010-01-01</creationDate>
      <effectiveDate>2009-01-01</effectiveDate>
      <author>
        <BusinessAssociate gml:id="a23">
          <gml:name>Joe Blow</gml:name>
        </BusinessAssociate>
      </author>
      <sourceSoftware>
        <SoftwareApplication gml:id="sap1">
          <gml:name>Autocad</gml:name>
        </SoftwareApplication>
      </sourceSoftware>
      <crs>
        <!-- Coordinate reference system definition for coordinates describing locations of trench wall observations.
        -->
        <LocalCartesianCRS gml:id="trench-wall-2d-crs-001">

          <!-- ================================================================== -->
          <!-- Standard GML CRS Properties -->
          <!-- ================================================================== -->

          <gml:description>
      Two-dimensional local Cartesian coordinate reference system for a vertical 
      trench wall. The X-axis runs horizontally along the wall face (bearing ~37° 
      from North), and the D-axis (depth) points vertically downward. Origin is at 
      the top southwest corner of the wall. The wall is 20 meters high.
    </gml:description>

          <gml:identifier codeSpace="http://diggsml.org/def/authorities.xml#DIGGS">
      trench-wall-2d-crs-001
    </gml:identifier>

          <gml:name>Local Coordinate System for Trench a22</gml:name>

          <gml:scope>
      Trench wall mapping and geological logging with 2D representation
    </gml:scope>

          <gml:scope>
      Documentation of soil layers, contacts, and features on vertical exposure in trench A22
    </gml:scope>

          <!-- ================================================================== -->
          <!-- Cartesian Coordinate System Definition (2D) -->
          <!-- ================================================================== -->

          <gml:cartesianCS>
            <gml:CartesianCS gml:id="trench-wall-2d-cs">
              <gml:identifier codeSpace="http://diggsml.org/def/authorities.xml#DIGGS">
          trench-wall-2d-cartesian-cs
        </gml:identifier>
              <gml:name>Trench Wall 2D Cartesian CS</gml:name>
              <gml:remarks>
          Two-dimensional Cartesian coordinate system for trench wall with
          X along wall (horizontal) and D downward (depth from top of wall)
        </gml:remarks>

              <!-- X Axis - Horizontal along wall face -->
              <gml:axis>
                <gml:CoordinateSystemAxis gml:id="x-axis" uom="m">
                  <gml:identifier codeSpace="http://diggsml.org/def/authorities.xml#DIGGS">x-horizontal-along-wall</gml:identifier>
                  <gml:name>X - Horizontal Along Wall</gml:name>
                  <gml:remarks>
              Horizontal axis running along the trench wall face from 
              southwest to northeast (bearing ~37°). Origin is at the 
              southwest corner at the top of the wall.
                  </gml:remarks>
                  <gml:axisAbbrev>X</gml:axisAbbrev>
                  <gml:axisDirection codeSpace="http://diggsml.org/def/authorities.xml#DIGGS">northeast</gml:axisDirection>
                </gml:CoordinateSystemAxis>
              </gml:axis>

              <!-- Depth Axis - Depth (positive downward from top) -->
              <gml:axis>
                <gml:CoordinateSystemAxis gml:id="d-axis" uom="m">
                  <gml:identifier codeSpace="http://diggsml.org/def/authorities.xml#DIGGS">d-depth-downward</gml:identifier>
                  <gml:name>D - Depth Below Top of Wall</gml:name>
                  <gml:remarks>
              Depth axis pointing vertically downward from the top of the wall.
              D=0 is at the top of the wall; D=20m is at the base of the wall.
              Positive values indicate increasing depth downward.
            </gml:remarks>
                  <gml:axisAbbrev>D</gml:axisAbbrev>
                  <gml:axisDirection codeSpace="EPSG">down</gml:axisDirection>
                </gml:CoordinateSystemAxis>
              </gml:axis>
            </gml:CartesianCS>
          </gml:cartesianCS>

          <!-- ================================================================== -->
          <!-- Engineering Datum -->
          <!-- ================================================================== -->

          <gml:engineeringDatum>
            <gml:EngineeringDatum gml:id="trench-wall-2d-datum">
              <gml:identifier codeSpace="http://diggsml.org/def/authorities.xml#DIGGS">trench-wall-2d-datum-001</gml:identifier>
              <gml:name>Trench Wall 2D Local Datum</gml:name>
              <gml:remarks>
                Datum defined by the southwest corner at the top of the trench wall
              </gml:remarks>
              <gml:scope/>
              <gml:anchorDefinition>
                Origin point at top of trench wall, southwest corner, elevation 25.0m NAVD88.
                The wall extends 20 meters downward to elevation 5.0m NAVD88 at the base.
             </gml:anchorDefinition>
            </gml:EngineeringDatum>
          </gml:engineeringDatum>

          <!-- ================================================================== -->
          <!-- Spatial Positioning: Origin Location (Top SW Corner) -->
          <!-- ================================================================== -->

          <originLocation>
            <PointLocation gml:id="trench-wall-2d-origin"
              srsName="https://www.opengis.net/def/crs-compound?1=http://www.opengis.net/def/crs/EPSG/0/26911&amp;2=http://www.opengis.net/def/crs/EPSG/0/5703">
              <gml:description>
                Origin  (0,0) at top of trench wall, southwest corner. 
                UTM Zone 11N (EPSG:26911) + NAVD88 height (EPSG:5703).
                This point is 20m above the base of the wall.
              </gml:description>
              <gml:pos>387516.665116977 3742645.12297961 5.0</gml:pos>
            </PointLocation>
          </originLocation>

          <!-- ================================================================== -->
          <!-- Spatial Positioning: X Axis (Horizontal along wall) -->
          <!-- ================================================================== -->

          <axisLocation xlink:href="#ply1_top">
            <AxisLocation gml:id="x-axis-location">
              <axisRef xlink:href="#x-axis"/>
              <axisOrder>1</axisOrder>
              <location xlink:href="#ply1_top">
                <!-- Here, location uses the referenceEdge in the above xlink:href as it is a horizontal line, but if unsuitable, can 
                  alternatively define a unit vector in spatial coords, as here, or you an define an axis of finite length.
                <inearExtent gml:id="x-axis-spatial-extent" srsDimension="3"
                  srsName="https://www.opengis.net/def/crs-compound?1=http://www.opengis.net/def/crs/EPSG/0/26911&amp;2=http://www.opengis.net/def/crs/EPSG/0/5703">
                  <gml:description>
                    Unit vector for X-axis: 1 meter horizontally along the wall face from origin.
                    Bearing approximately 36.87° from North. Elevation remains constant at 5.0m.
                  </gml:description>
                  <gml:posList>
                    387516.665116977 3742645.12297961 5.0
                    387517.265116977 3742645.92297961 5.0
                  </gml:posList>
                </LinearExtent>
                -->
              </location>

              <directionVector> 0.6 0.8 0.0 </directionVector>
            </AxisLocation>
          </axisLocation>

          <!-- ================================================================== -->
          <!-- Spatial Positioning: D Axis (Depth, positive downward) -->
          <!-- ================================================================== -->

          <axisLocation>
            <diggs:AxisLocation gml:id="d-axis-location">
              <axisRef xlink:href="#d-axis"/>
              <axisOrder>2</axisOrder>
              <location>
                <diggs:LinearExtent gml:id="d-axis-spatial-extent" srsDimension="3"
                  srsName="https://www.opengis.net/def/crs-compound?1=http://www.opengis.net/def/crs/EPSG/0/26911&amp;2=http://www.opengis.net/def/crs/EPSG/0/5703">
                  <gml:description>
              Full extent of D-axis: 20 meters vertically downward from top of wall.
              Starts at elevation 5.0m (D=0) and extends to elevation -15.0m (D=20m).
            </gml:description>
                  <gml:posList> 387516.665116977 3742645.12297961 5 387546.665116977
                    3742685.12297961 -15 </gml:posList>
                </diggs:LinearExtent>
              </location>

              <directionVector
                srsName="https://www.opengis.net/def/crs-compound?1=http://www.opengis.net/def/crs/EPSG/0/26911&amp;2=http://www.opengis.net/def/crs/EPSG/0/5703"
                > 0.0 0.0 -1.0 </directionVector>
            </diggs:AxisLocation>
          </axisLocation>

          <!-- ================================================================== -->
          <!-- Transformation Parameters -->
          <!-- ================================================================== -->

          <transformationMethod>affine</transformationMethod>
          <rotationAngle uom="dega">36.8699</rotationAngle>
          <scaleFactor>1.0</scaleFactor>
          <transformationAccuracy uom="m">0.01</transformationAccuracy>
        </LocalCartesianCRS>
      </crs>
    </DocumentInformation>
  </documentInformation>

  <project>
    <Project gml:id="p1">
      <gml:name>Test Project</gml:name>
      <!-- <gml:identifier codeSpace="usgs">urn:diggs:def:fi:USGS:usgs_p1</gml:identifier> -->
      <remark>
        <Remark>
          <content>This could be a virtual project that has no relevance outside of this
            instance</content>
        </Remark>
      </remark>
    </Project>
  </project>

  <samplingFeature>
    <TrenchWall gml:id="a22">
      <gml:identifier codeSpace="usgs">urn:diggs:def:fi:USGS:usgs_a22</gml:identifier>
      <gml:name>My trench</gml:name>
      <investigationTarget>Natural Ground</investigationTarget>
      <projectRef xlink:href="#p1"/>
      <referencePoint>
        <PointLocation gml:id="a34">
          <gml:pos
            srsName="https://www.opengis.net/def/crs-compound?1=http://www.opengis.net/def/crs/EPSG/0/26911%262=http://www.opengis.net/def/crs/EPSG/0/5703"
            >387516.665116977 3742645.12297961 5</gml:pos>
        </PointLocation>
      </referencePoint>
      <referenceEdge>
        <LinearExtent gml:id="ply1_top" srsDimension="3"
          srsName="https://www.opengis.net/def/crs-compound?1=http://www.opengis.net/def/crs/EPSG/0/26911%262=http://www.opengis.net/def/crs/EPSG/0/5703">
          <gml:posList>387516.665116977 3742645.12297961 5 387546.665116977 3742685.12297961
            5</gml:posList>
        </LinearExtent>
      </referenceEdge>
      <relativeFeatureBoundary>
        <PlanarSurface srsDimension="2" srsName="#trench-wall-2d-crs-001" gml:id="ply1">
          <gml:exterior>
            <gml:LinearRing>
              <gml:posList>0 0 50 0 50 10 0 10 0 0</gml:posList>
            </gml:LinearRing>
          </gml:exterior>
        </PlanarSurface>
      </relativeFeatureBoundary>

      <!-- VectorLinearReferenceSystem deprecated in v. 3.0. Use LocalCartesianCRS instead (see in DocumentInformation)
 
 <planarReferencing>
        <VectorLinearSpatialReferenceSystem gml:id="lsrs002">
          <gml:identifier codeSpace="urn:x-diggs:def:authority:DIGGSINC">urn:diggs:def:fi:DIGGSINC:lsrs002</gml:identifier>
          <glr:linearElement xlink:href="#ply1_top"/>
          <glr:lrm xlink:href="#lr123"/>
          -->
      <!-- from gmllr:LinearSRSType -->
      <!-- PwD 2015-04-14 restored; 2015-04-20 added offsetUom attribute -->
      <!--
          <offsetVector srsName="urn:ogc:def:crs:EPSG::7405" offsetUom="m">0 0 -1</offsetVector>
      -->
      <!--
          <linearReferencingMethodUncertainty>
            <LocationUncertainty gml:id="LocationUncertainty_cyx_jnj_ghc">
              <locationMethod>tape</locationMethod>
              <xValueUncertainty>
                <Uncertainty gml:id="oojoow">
                  <plusUncertaintyValue>0.1</plusUncertaintyValue>
                  <minusUncertaintyValue>0.1</minusUncertaintyValue>
                </Uncertainty>
              </xValueUncertainty>
            </LocationUncertainty>
          </linearReferencingMethodUncertainty>
        </VectorLinearSpatialReferenceSystem>
      </planarReferencing>
      -->

      <constructionMethod>
        <TrenchConstructionMethod gml:id="cm22">
          <gml:name>backhoe</gml:name>
          <remark>
            <Remark>
              <content>Backhoe was brand new and worked like a charm</content>
            </Remark>
          </remark>
        </TrenchConstructionMethod>
      </constructionMethod>

    </TrenchWall>
  </samplingFeature>

  <observation>

    <!-- Fault observation in trench wall -->

    <DiscontinuitySystem gml:id="lst1">
      <gml:name>Faults</gml:name>
      <projectRef xlink:href="#p1"/>
      <samplingFeatureRef xlink:href="#a22"/>
      <discontinuityType>fault</discontinuityType>
      <discontinuityObservation>
        <DiscontinuityObservation gml:id="flt-1">
          <location>
            <LinearExtent gml:id="twpl1" srsDimension="2" srsName="#trench-wall-2d-crs-001">
              <!-- The srsName value is defined above in the planarReferencing property -->
              <gml:posList>5 6 3 4 2 1</gml:posList>
            </LinearExtent>
          </location>
          <fractureObservation>
            <FractureObservation gml:id="fd-1">
              <gml:name>Fault A</gml:name>
              <type>normal fault</type>
            </FractureObservation>
          </fractureObservation>
        </DiscontinuityObservation>
      </discontinuityObservation>
    </DiscontinuitySystem>
  </observation>

  <observation>

    <!-- Soil descriptions -->

    <LithologySystem gml:id="lst_usc">
      <gml:name>Soils in trench wall</gml:name>
      <projectRef xlink:href="#p1"/>
      <samplingFeatureRef xlink:href="#a22" identifierRef="urn:diggs:def:fi:USGS:usgs_a22"/>
      <lithologyClassificationType>Soil                    x </lithologyClassificationType>
      <lithologyObservation>
        <LithologyObservation gml:id="lst-h1">
          <location>
            <PlanarObservationRepresentation gml:id="li-1">
              <layerTopIntersection>
                <LinearExtent gml:id="twp-int-11" srsDimension="2" srsName="#trench-wall-2d-crs-001">
                  <gml:posList>0 2 10 2.5 20 4 30 3 40 2 50 1</gml:posList>
                </LinearExtent>
              </layerTopIntersection>
              <layerBaseIntersection>
                <LinearExtent gml:id="twp-int-12" srsDimension="2" srsName="#trench-wall-2d-crs-001">
                  <!--replace by posList with coordinate order reversed (to show use of OrientableCurve
                        <gml:posList srsDimension="2" srsName="#trench-wall-2d-crs-001">50 4 40 5 30 6 20 7 10
                        5.5 0 5</gml:posList>
                      -->
                  <gml:posList>0 5 10 5.5 20 7 30 6 40 5 50 4</gml:posList>
                </LinearExtent>
              </layerBaseIntersection>
              <representativeSurface>
                <PlanarSurface gml:id="lt1-p">
                  <gml:exterior>
                    <gml:Ring>
                      <gml:curveMember xlink:href="#twp-int-11"/>
                      <!--Top edge -->
                      <gml:curveMember>
                        <gml:LineString gml:id="lt1-1">
                          <!--Right edge -->
                          <gml:posList srsDimension="2" srsName="#trench-wall-2d-crs-001">50 1 50
                            4</gml:posList>
                        </gml:LineString>
                      </gml:curveMember>
                      <gml:curveMember>
                        <gml:OrientableCurve gml:id="OC_twp-int-12" orientation="-">
                          <gml:baseCurve xlink:href="#twp-int-12"/>
                        </gml:OrientableCurve>
                      </gml:curveMember>
                      <!--Basal edge in reverse orientation -->
                      <gml:curveMember>
                        <gml:LineString gml:id="lt1-2">
                          <!--Left edge -->
                          <gml:posList srsDimension="2" srsName="#trench-wall-2d-crs-001">0 5 0
                            2</gml:posList>
                        </gml:LineString>
                      </gml:curveMember>
                    </gml:Ring>
                  </gml:exterior>
                </PlanarSurface>
              </representativeSurface>
            </PlanarObservationRepresentation>
          </location>
          <primaryLithology>
            <Lithology gml:id="tw1">
              <classificationCode codeSpace="https://diggsml.org/def/codes/DIGGS/0.1/astmD2488.xml#SP">Poorly graded sand</classificationCode>
              <lithDescription>coarse sand</lithDescription>
            </Lithology>
          </primaryLithology>
        </LithologyObservation>
      </lithologyObservation>
      <lithologyObservation>
        <LithologyObservation gml:id="lst-h2">
          <location>
            <PlanarObservationRepresentation gml:id="li-2">
              <layerTopIntersection xlink:href="#twp-int-12"/>
              <layerBaseIntersection>
                <LinearExtent gml:id="twp-int-32" srsDimension="2" srsName="#trench-wall-2d-crs-001">
                  <gml:posList>0 6 10 6.5 20 8 30 7 40 6 50 5</gml:posList>
                </LinearExtent>
              </layerBaseIntersection>
              <representativeSurface>
                <PlanarSurface gml:id="lt2-p">
                  <gml:exterior>
                    <gml:Ring>
                      <!--Top edge -->
                      <gml:curveMember xlink:href="#twp-int-12"/>
                      <!--Left edge -->
                      <gml:curveMember>
                        <gml:LineString gml:id="lt2-1">
                          <gml:posList srsDimension="2" srsName="#trench-wall-2d-crs-001">0 5 0
                            6</gml:posList>
                        </gml:LineString>
                      </gml:curveMember>
                      <!--Basal edge -->
                      <gml:curveMember xlink:href="#twp-int-32"/>
                      <!--Right edge -->
                      <gml:curveMember>
                        <gml:LineString gml:id="lt2-2">
                          <gml:posList srsDimension="2" srsName="#trench-wall-2d-crs-001">50 5 50
                            4</gml:posList>
                        </gml:LineString>
                      </gml:curveMember>
                    </gml:Ring>
                  </gml:exterior>
                </PlanarSurface>
              </representativeSurface>
            </PlanarObservationRepresentation>
          </location>
          <trueTopObserved>true</trueTopObserved>
          <trueBaseObserved>true</trueBaseObserved>
          <primaryLithology>
            <Lithology gml:id="tw2" xmlns:ns1="http://schemas.diggsml.org/2.0.b">
              <classificationCode codeSpace="https://diggsml.org/def/codes/DIGGS/0.1/astmD2488.xml#sML">Sandy silt</classificationCode>
              <lithDescription howDetermined="visual">grey sandy silt</lithDescription>
            </Lithology>
          </primaryLithology>
        </LithologyObservation>
      </lithologyObservation>
    </LithologySystem>
  </observation>

</Diggs>
